# TapeSort: Внешняя сортировка для ленточных накопителей

Проект реализует алгоритм внешней сортировки для данных, хранящихся на эмулируемых ленточных накопителях. Разработан в качестве тестового задания для отбора на стажировку YADRO.Импульс 2025 в команду TATLIN.Unified.

## Описание задачи

Устройство хранения данных типа Tape предназначено для последовательной записи и чтения данных. Считывающая/записывающая магнитная головка неподвижна во время чтения и записи, а лента имеет возможность двигаться в обоих направлениях. Запись и чтение информации возможны в ячейку ленты, на которой в данный момент находится магнитная головка. Перемещения ленты — затратная по времени операция, лента не предназначена для произвольного доступа.

Необходимо реализовать консольное приложение на C++, которое сортирует по возрастанию целочисленные значения (int32_t) с входной ленты на выходную. Длина лент (N) может быть велика, а доступная оперативная память (M) ограничена (M может быть < N * sizeof(int32_t)). Для работы разрешено использовать временные ленты.

## Реализация

Проект включает:

*   **Интерфейс `Tape`**: Абстрактный класс, определяющий операции с ленточным накопителем (чтение, запись, сдвиг головки, перемотка).
*   **Класс `FileTape`**: Реализация интерфейса `Tape`, эмулирующая работу ленты с помощью обычного файла. Поддерживает конфигурацию задержек для различных операций через внешний YAML-файл.
*   **Алгоритмы сортировки**:
    *   **Сортировка подсчетом (`CountingSort`)**: Реализована для случаев, когда диапазон значений известен или может быть определен и умещается в доступную память (с учетом возможного разбиения диапазона на окна).
    *   **Внешняя многофазная сортировка слиянием (`ChunkMergeSort`)**: Классический алгоритм внешней сортировки. Данные с входной ленты разбиваются на отсортированные в оперативной памяти части (чанки), которые записываются на временные ленты. Затем эти чанки итеративно сливаются до получения полностью отсортированной ленты. В качестве алгоритма сортировки чанков в памяти можно выбрать `std::sort` или `std::sort_heap` (через конфигурацию).
*   **Конфигурация**: Параметры работы `FileTape` (задержки) и алгоритмов сортировки (лимит памяти, выбор алгоритма для чанков, опциональный диапазон для сортировки подсчетом) загружаются из YAML-файла.
*   **Консольное приложение**: Принимает на вход имена входного, выходного файлов и (опционально) файла конфигурации.
*   **Юнит-тесты**: Написаны с использованием GoogleTest для проверки корректности работы `FileTape`, загрузки конфигурации и алгоритмов сортировки.

## Зависимости

Для сборки и запуска проекта необходимы:

*   **Компилятор C++17** (или новее)
*   **CMake** (версия 3.10 или новее)
*   **yaml-cpp**: Библиотека для работы с YAML-файлами конфигурации.
*   **GoogleTest**: Фреймворк для написания юнит-тестов.
*   **(Рекомендуется) vcpkg**: Менеджер пакетов для C++, упрощающий установку зависимостей `yaml-cpp` и `GoogleTest`.

## Сборка проекта

Рекомендуется использовать `vcpkg` для установки зависимостей.

1.  **Установите `vcpkg`** (если еще не установлен):
    ```bash
    git clone https://github.com/microsoft/vcpkg.git
    cd vcpkg
    ./bootstrap-vcpkg.bat  # для Windows
    # ./bootstrap-vcpkg.sh  # для Linux/macOS
    ./vcpkg integrate install
    ```

2.  **Установите зависимости через `vcpkg`**:
    ```bash
    vcpkg install yaml-cpp:x64-windows gtest:x64-windows # Для Windows (64-bit)
    # vcpkg install yaml-cpp:x64-linux gtest:x64-linux   # Пример для Linux (64-bit)
    # Замените x64-windows на ваш целевой триплет, если необходимо
    ```

3.  **Сконфигурируйте проект с помощью CMake**:
    Перейдите в корневую директорию проекта.
    ```bash
    cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=[путь_к_vcpkg]/scripts/buildsystems/vcpkg.cmake -DVCPKG_TARGET_TRIPLET=[ваш_триплет]
    # Пример для Windows:
    # cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=C:/dev/vcpkg/scripts/buildsystems/vcpkg.cmake -DVCPKG_TARGET_TRIPLET=x64-windows
    ```
    Замените `[путь_к_vcpkg]` на актуальный путь к вашей установке `vcpkg` и `[ваш_триплет]` на ваш целевой триплет (например, `x64-windows`, `x64-linux`).

4.  **Соберите проект**:
    ```bash
    cmake --build build --config Release # Или Debug
    ```
    Исполняемый файл `ext_tape_sort` (или `ext_tape_sort.exe`) будет находиться в директории `build/` (или `build/Release/`, `build/Debug/`).

## Запуск приложения

```bash
./build/ext_tape_sort <input_file.bin> <output_file.bin> [config.yaml]